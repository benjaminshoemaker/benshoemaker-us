---
import type { RecentRepo } from '../lib/github';
import { formatRelativeTime } from '../lib/github';

interface Props {
  repos: RecentRepo[] | null;
}

const { repos } = Astro.props;
---

{repos && repos.length > 0 && (
  <div class="space-y-3">
    {repos.map((repo) => (
      <a
        href={repo.url}
        target="_blank"
        rel="noopener noreferrer"
        class="block p-4 bg-surface-raised border border-border rounded-lg hover:border-accent/30 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-focus"
      >
        <div class="flex items-start justify-between gap-3">
          <div class="min-w-0 flex-1">
            <h3 class="text-sm font-semibold text-text-primary">{repo.name}</h3>
            {repo.description && (
              <p class="text-sm text-text-body mt-0.5 line-clamp-1">{repo.description}</p>
            )}
            {repo.defaultBranchRef?.target && (
              <p class="text-xs text-text-muted mt-1 truncate">
                <span class="inline-block w-3 h-3 align-text-bottom mr-1">
                  <svg viewBox="0 0 16 16" fill="currentColor" class="w-3 h-3">
                    <path d="M11.93 8.5a4.002 4.002 0 0 1-7.86 0H.75a.75.75 0 0 1 0-1.5h3.32a4.002 4.002 0 0 1 7.86 0h3.32a.75.75 0 0 1 0 1.5Zm-1.43-.25a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z" />
                  </svg>
                </span>
                {repo.defaultBranchRef.target.messageHeadline}
              </p>
            )}
          </div>
          <span class="shrink-0 text-xs text-text-muted whitespace-nowrap mt-0.5">
            {formatRelativeTime(repo.pushedAt)}
          </span>
        </div>
      </a>
    ))}
  </div>
)}
